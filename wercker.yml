box: wercker/nodejs
build:
    steps:
        - npm-install

        - script:
                name: npm run-script test-drone
                code: |
                    npm run-script test-drone

        - script:
                name: echo nodejs information
                code: |
                    echo "node version $(node -v) running"
                    echo "npm version $(npm -v) running"

    after-steps:
        - wantedly/pretty-slack-notify:
                webhook_url: $SLACK_WEBHOOK_URL

deploy:
    steps:
        - add-to-known_hosts:
            hostname: dotcloudapp.com
            fingerprint: 8b:1d:ac:91:0c:92:a8:ea:3c:95:1b:d0:fb:df:f3:13

        - starefossen/dotcloud-deploy:
            keyname: SSHKEY
            dcemail: $DC_EMAIL
            dcpassword: $DC_PASSWORD
            appname: $APPNAME

        #- kwakayama/npm-publish

